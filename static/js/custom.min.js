if(window.location.pathname.startsWith("/post/")){let e=null,l=null;document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".main .post-single>.toc"),s=t?t.offsetTop:0,o=document.querySelector("header.header"),n=document.querySelector(".main .toc"),c=[];if(null!==n){const t=n.cloneNode(!0);t.classList.add("aside"),t.querySelector("details").setAttribute("open","");const o=t.querySelectorAll(".inner ul>li");for(let e=0;e<o.length;e++)o[e].classList.contains("non-selected")||(o[e].classList.add("non-selected"),c[e]=decodeURI(o[e].querySelector("a").getAttribute("href").substring(1)));if(s<window.pageYOffset?t.classList.add("reveal"):s>=window.pageYOffset&&t.classList.add("hide"),n.parentNode.insertBefore(t,n.nextSibling),s<window.pageYOffset){const t=document.querySelectorAll(".main .toc.aside .inner ul>li");for(let s=0;s<c.length;s++){let o=document.getElementById(c[s]),n=document.getElementById(c[s+1]);null!==n&&window.pageYOffset>=o.offsetTop&&window.pageYOffset<n.offsetTop&&(l=t[s],e=s)}}}const i=document.querySelector(".main .toc.aside");let d=null,a=null,r=0;window.addEventListener("scroll",()=>{const e=window.pageYOffset;if(null!==n&&s>=e&&i.classList.contains("reveal")&&(i.scrollTop=0,i.classList.remove("reveal"),i.classList.add("hide")),e<=0&&!o.classList.contains("scroll-up"))return o.classList.remove("scroll-down"),void o.classList.add("scroll-up");if(e<=10)o.classList.remove("scroll-up");else{if(e>80&&(e>r&&!o.classList.contains("scroll-down")?(o.classList.remove("scroll-up"),o.classList.add("scroll-down")):e<r&&o.classList.contains("scroll-down")&&(o.classList.remove("scroll-down"),o.classList.add("scroll-up"))),null!==n){s<e&&i.classList.contains("hide")?(i.classList.remove("hide"),i.classList.add("reveal")):s>=e&&i.classList.contains("reveal")&&(i.scrollTop=0,i.classList.remove("reveal"),i.classList.add("hide"));const l=i.querySelectorAll(".inner ul>li");let t=null;for(let s=0;s<c.length;s++){document.getElementById(c[s]).offsetTop<=e&&(d=l[s],t=s)}if(null!==t){if(Math.ceil(e+window.innerHeight)>=document.body.scrollHeight){for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected");l[c.length-1].classList.add("selected"),a=l[c.length-1]}else{if(d===a&&t>0)return;for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected");d.classList.add("selected"),a=d}null!==t&&i.scroll({behavior:"smooth",top:20*t})}else{if(null===i.querySelector(".selected"))return;for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected")}}r=e}});const u=document.querySelector(".main .toc.aside details");if(null!==u){new MutationObserver((e,l)=>{if(null===e[0].oldValue)for(let e=0;e<c.length;e++){let l=document.getElementById(c[e]),t=document.getElementById(c[e+1]);if(null!==t&&window.pageYOffset>=l.offsetTop&&window.pageYOffset<t.offsetTop){Math.ceil(window.pageYOffset+window.innerHeight)>=document.body.scrollHeight?(i.querySelectorAll(".inner ul>li")[c.length-1].classList.add("selected"),i.scrollTop=20*(c.length-1)):(i.querySelectorAll(".inner ul>li")[e].classList.add("selected"),i.scrollTop=20*e)}}}).observe(u,{attributes:!0,attributeOldValue:!0,attributeFilter:["open"]})}}),window.onload=function(){null!==e&&(l.classList.add("selected"),document.querySelector(".main .toc.aside").scrollTop=20*e)}}
