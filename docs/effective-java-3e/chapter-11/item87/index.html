<!doctype html><html id=top lang=ko dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>&lt;Qutrits/></title>
<meta name=keywords content>
<meta name=description content="[아이템 87] 커스텀 직렬화 형태를 고려해보라. 이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Name implements Serializable { /* * 성. null이 아니어야 함. * @serial */ private final String lastName; /* * 이름.">
<meta name=author content>
<link rel=canonical href=https://qutrits.github.io/effective-java-3e/chapter-11/item87/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.deb937c6e25543113704c39c42196f0e87690a2a16619dc74111fe9c1b515353.css integrity="sha256-3rk3xuJVQxE3BMOcQhlvDodpCioWYZ3HQRH+nBtRU1M=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://qutrits.github.io/icon/favicon-64.webp>
<link rel=icon type=image/png sizes=16x16 href=https://qutrits.github.io/icon/favicon-16.webp>
<link rel=icon type=image/png sizes=32x32 href=https://qutrits.github.io/icon/favicon-32.webp>
<link rel=apple-touch-icon href=https://qutrits.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://qutrits.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.4">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-215417930-1','auto'),ga('send','pageview'))</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-215417930-1','auto'),ga('send','pageview'))</script><meta property="og:title" content>
<meta property="og:description" content="[아이템 87] 커스텀 직렬화 형태를 고려해보라. 이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Name implements Serializable { /* * 성. null이 아니어야 함. * @serial */ private final String lastName; /* * 이름.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://qutrits.github.io/effective-java-3e/chapter-11/item87/"><meta property="article:section" content="effective-java-3e">
<meta name=twitter:card content="summary">
<meta name=twitter:title content>
<meta name=twitter:description content="[아이템 87] 커스텀 직렬화 형태를 고려해보라. 이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Name implements Serializable { /* * 성. null이 아니어야 함. * @serial */ private final String lastName; /* * 이름.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Effctive Java 3/E","item":"https://qutrits.github.io/effective-java-3e/"},{"@type":"ListItem","position":2,"name":"11장 직렬화","item":"https://qutrits.github.io/effective-java-3e/chapter-11/"},{"@type":"ListItem","position":3,"name":"","item":"https://qutrits.github.io/effective-java-3e/chapter-11/item87/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"[아이템 87] 커스텀 직렬화 형태를 고려해보라. 이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Name implements Serializable { /* * 성. null이 아니어야 함. * @serial */ private final String lastName; /* * 이름.","keywords":[],"articleBody":"[아이템 87] 커스텀 직렬화 형태를 고려해보라. 이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  public class Name implements Serializable { /* * 성. null이 아니어야 함. * @serial */ private final String lastName; /* * 이름. null이 아니어야 함. * @serial */ private final String firstName; /* * 이름. null이 아니어야 함. * @serial */ private final String middleName; .. }   성명은 논리적으로 이름, 성, 중간이라는 3개의 문자열로 구성되며, 앞 코드의 인스턴스 필드들은 이 논리적 구성요소를 정확히 반영했음.\n\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  // 기본 직렬화 형태에 적합하지 않은 클래스 public final class StringList implements Serializable { private int size = 0; private Entry head = null; private static class Entry implements Serializable { String data; Entry next; Entry previous; } .. }   객체의 물리적 표환과 논리적 표현의 차이가 클 때 기본 직렬화를 사옹하면 발생하는 문제점   공개 API가 현재 내부 표현 방식에 영구히 묶인다. 위 코드에서는 StringList.Entry가 공개 API가 되어버린다. \n다음 릴리스에서 내부 표현 방식을 변경하더라도 StringList 클래스는 연결 리스트로 펴현된 입력도 처리할 수 있어야한다.\n  너무 많은 공간을 차지할 수 있다.위 코드에서 직렬화에 필요없는 연결리스트의 모든 엔트리와 연결 정보까지 저장했다.이처럼 직렬화 형태가 너무 커져서 디스크에 저장하거나 네트워크에 전송하는 속도가 느려질 수 있다.\n  시간이 너무 많이 걸릴 수 있다. 직렬화 로직은 객체 그래프의 위상에 관한 정보가 없어서 그래프를 직접 순회해볼 수 밖에 없다.\n  스택 오버플로를 일으킬 수 있다. 기본 직렬화 과정은 객체 그래프를 재귀 순회하는데 크기가 크지 않는 객체 그래프에서도 오버플로를 일으킬 수 있다.\n  StringList를 합리적으로 직렬화려면 리스트가 포함한 문자열의 개수를 적은 뒤, 그 뒤로 문자열을 나열하는 수준이면 된다. 논리적인 구성만 담는 것이다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36  public final class StringList implements Serializable { private transient int size = 0; private transient Entry head = null; // 더이상 직렬화 x  private static class Entry { String data; Entry next; Entry previous; } // 지정한 문자열을 이 리스트에 추가  public final void add(String s) { ... } /** * Serialize this {@code StringList} instance. * * @serialData 이 리스트의 크기(포함된 문자열의 개수) 를 기록한 후 ({@code int}), 이어서 모든 원소를(각각은 {@code String})순서대로 기 */ private void writeObject(ObjectOutputStream s) throws IOException { s.defaultWriteObject(); s.writeInt(size); // 모든 원소를 올바른 순서로 기록한  for (Entry e = head; e != null; e = e.next) s.writeObject(e.data); } private void readObject(ObjectInputStream s) throws IOException, ClassNotFoundException { s.defaultReadObject(); int numElements = s.readInt(); // 모든 원소를 읽어 이 리스트에 삽입한다  for (int i = 0; i  numElements; i++) add((String) s.readObject()); } .. }   transient이어도 defaultWriteObject, defaultReadObject를 호출해야 한다. 그래야 향후 릴리스에서 trasient가 아닌 인스턴스 필드가 추가되더라도 상호 호환이 되기 때문이다. \n기본 직렬화 사용 여부와 상관없이 객체의 전체 상태를 읽는 메서드에 적용해야 하는 동기화 메커니즘을 직렬화에도 적용해야한다.\n1 2 3 4 5  // 기본 직렬화를 사용하는 동기화된 클래스를 위한 writeObject 메서드 private synchronized void writeObject(ObjectOutputStream s) throws IOException { s.defaultWriteObject(); }   writeObject 메서드 안에서 동기화하고 싶으면 클래스의 다른 부분에서 사용하는 락 순서를 똑같이 해야한다. 그렇지 않으면 교착상태에 빠질 수 있다.\n\r\r어떤 직렬화 형태를 택하든 직렬화 가능 클래스 모두에 직렬버전 UID를 명시적으로 부여해주자.\n이렇게 해야 잠재적인 호환성 문제가 사라진다. 성능도 조금 빨라지는데 명시하지 않을 경우 런타임에 UID 값을 생성하는 연산을 수행하기 때문이다. 구버전하고 호환성을 끊으려면 값을 변경해주면 된다.\n","wordCount":"587","inLanguage":"ko","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://qutrits.github.io/effective-java-3e/chapter-11/item87/"},"publisher":{"@type":"Organization","name":"\u003cQutrits/\u003e","logo":{"@type":"ImageObject","url":"https://qutrits.github.io/icon/favicon-64.webp"}}}</script>
</head>
<body>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class="header header-bottom">
<nav class=nav>
<div class=logo>
<a href=https://qutrits.github.io/ accesskey=h title="<Qutrits/> (Alt + H)"><svg viewBox="0 0 32 32" width="26" height="26"><path d="M30 15a1 1 0 01-.58-.19L16 5.23 2.58 14.81a1 1 0 01-1.16-1.62l14-10a1 1 0 011.16.0l14 10A1 1 0 0130 15z"/><path d="M5 9A1 1 0 014 8V4A1 1 0 015 3H9A1 1 0 019 5H6V8A1 1 0 015 9z"/><path d="M25 29H20a1 1 0 01-1-1V21H13v7a1 1 0 01-1 1H7a3 3 0 01-3-3V16a1 1 0 012 0V26a1 1 0 001 1h4V20a1 1 0 011-1h8a1 1 0 011 1v7h4a1 1 0 001-1V16a1 1 0 012 0V26a3 3 0 01-3 3z"/></svg>&lt;Qutrits/></a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<button id=menu-trigger aria-haspopup=menu aria-label="Menu Button"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</button>
<ul id=menu class="main-menu hidden">
<li>
<a href=https://qutrits.github.io/series-list/ title=시리즈>
<span>시리즈</span>
</a>
</li>
<li>
<a href=https://qutrits.github.io/collection/ title=모아보기>
<span>모아보기</span>
</a>
</li>
<li>
<a href=https://qutrits.github.io/archives/ title="기록 보관소">
<span>기록 보관소</span>
</a>
</li>
<li>
<a href=https://qutrits.github.io/search/ title="검색 (Alt + /)" accesskey=/>
<span>검색</span>
</a>
</li>
<li>
<a href=https://qutrits.github.io/tags/ title=태그>
<span>태그</span>
</a>
</li>
</ul>
</nav>
</header>
<script>let b=document.querySelector("#menu-trigger"),m=document.querySelector("#menu");b.addEventListener("click",function(){m.classList.toggle("hidden")}),document.body.addEventListener("click",function(a){b.contains(a.target)||m.classList.add("hidden")})</script>
<script>function loding_indicator(b,a){if(b===!0){const b=document.createElement("div");b.id="loading-indicator",b.innerHTML='<div class="spinner"></div>',a.parentNode.insertBefore(b,a.nextSibling)}else{const a=document.getElementById("loading-indicator");a.classList.add("scale-zero")}}</script><main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title data-animation=true>
</h1>
<div class=post-meta data-animation=true><a class=edit-post href=https://github.com/qutrits/qutrits.github.io/blob/main/content/effective-java-3e/chapter-11/Item87.md rel="noopener noreferrer" target=_blank>수정사항 제안</a>
&nbsp;&nbsp;|&nbsp;&nbsp;<span class=font-size-button>
<a id=font-size-default aria-label="Increase Font size" title="Go to Top (Alt + G)" accesskey=e><svg class="button default" width="21" height="21" viewBox="0 0 24 24"><path d="M7.20711 2.54289c.39052.39053.39052 1.02369.0 1.41422L5.41421 5.75H13.25c4.4183.0 8 3.58172 8 8 0 4.4183-3.5817 8-8 8-4.41828.0-8-3.5817-8-8 0-.552300000000001.44772-1 1-1s1 .447699999999999 1 1c0 3.3137 2.68629 6 6 6 3.3137.0 6-2.6863 6-6s-2.6863-6-6-6H5.41421l1.7929 1.79289c.39052.39053.39052 1.02371.0 1.41421C6.81658 11.3476 6.18342 11.3476 5.79289 10.9571l-3.5-3.49999c-.39052-.39053-.39052-1.02369.0-1.41422l3.5-3.5c.39053-.39052 1.02369-.39052 1.41422.0z" fill="#212121"/></svg>
</a>
&nbsp;
<a id=font-size-increase aria-label="Decrease Font size" title="Go to Top (Alt + G)" accesskey=d><svg class="button increase" width="21" height="21" viewBox="0 0 24 24"><path d="M5.12 14 7.5 7.67 9.87 14M6.5 5 1 19H3.25l1.12-3h6.25l1.13 3H14L8.5 5h-2M18 7l-5 5.07 1.41 1.43L17 10.9V17h2V10.9l2.59 2.6L23 12.07 18 7z"/></svg>
</a>
&nbsp;
<a id=font-size-decrease aria-label="Reset Font size" title="Go to Top (Alt + G)" accesskey=f><svg class="button decrease" width="21" height="21" viewBox="0 0 24 24"><path d="M5.12 14 7.5 7.67 9.87 14M6.5 5 1 19H3.25l1.12-3h6.25l1.13 3H14L8.5 5h-2M18 17l5-5.07-1.41-1.43L19 13.1V7H17v6.1l-2.59-2.6L13 11.93 18 17z"/></svg>
</a>
</span>
<span class=display-font-size-info>100%</span>
<script>const postFontSize_DOMReady=function(a){document.readyState==="interactive"||document.readyState==="complete"?a():document.addEventListener("DOMContentLoaded",a)};postFontSize_DOMReady(function(){if(localStorage.getItem("post-content-font-size")){const a=document.querySelector(".main .post-single .post-content"),b=document.querySelector(".display-font-size-info"),c=document.querySelector(".aside-display-font-size-info");a.style.fontSize=localStorage.getItem("post-content-font-size")+"%",b.innerText=localStorage.getItem("post-content-font-size")+"%",c.innerText=localStorage.getItem("post-content-font-size")+"%"}else localStorage.setItem("post-content-font-size",100);const a=document.getElementById("font-size-default"),b=document.getElementById("font-size-decrease"),c=document.getElementById("font-size-increase");c.addEventListener("click",a=>{if(localStorage.getItem("post-content-font-size")){let a=parseInt(localStorage.getItem("post-content-font-size"));if(a+10>200)return;const b=document.querySelector(".main .post-single .post-content"),c=document.querySelector(".display-font-size-info"),d=document.querySelector(".aside-display-font-size-info");b.style.fontSize=a+10+"%",c.innerText=a+10+"%",d.innerText=a+10+"%",localStorage.setItem("post-content-font-size",a+10)}else _postContent.style.fontSize="105%",_displayFontSizeInfo.innerText="105%",_asideDisplayFontSizeInfo.innerText="105%",localStorage.setItem("post-content-font-size",105)}),b.addEventListener("click",a=>{if(localStorage.getItem("post-content-font-size")){let a=parseInt(localStorage.getItem("post-content-font-size"));if(a-5<50)return;const b=document.querySelector(".main .post-single .post-content"),c=document.querySelector(".display-font-size-info"),d=document.querySelector(".aside-display-font-size-info");b.style.fontSize=a-10+"%",c.innerText=a-10+"%",d.innerText=a-10+"%",localStorage.setItem("post-content-font-size",a-10)}else _postContent.style.fontSize="95%",_displayFontSizeInfo.innerText="95%",_asideDisplayFontSizeInfo.innerText="95%",localStorage.setItem("post-content-font-size",95)}),a.addEventListener("click",c=>{const d=document.querySelector(".main .post-single .post-content"),a=document.querySelector(".display-font-size-info"),b=document.querySelector(".aside-display-font-size-info");postContent.style.fontSize="100%",a.innerText="100%",b.innerText="100%",localStorage.setItem("post-content-font-size",100)})})</script>
</div>
</header>
<div class=post-content data-animation=true><h1 id=아이템-87-커스텀-직렬화-형태를-고려해보라>[아이템 87] 커스텀 직렬화 형태를 고려해보라.<a hidden class=anchor aria-hidden=true href=#아이템-87-커스텀-직렬화-형태를-고려해보라>#</a></h1>
<p>이상적인 직렬화는 물리적인 모습과 독립된 논리적인 모습을 표현해야한다. 하지만 기본 직렬화 형태는 객체가 포함한 모든 데이터와 그 객체에서부터 시작해 접근할 수 있는 모든 객체를 담아낸다.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Name</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
    <span class=cm>/*
</span><span class=cm>     * 성. null이 아니어야 함.
</span><span class=cm>     * @serial
</span><span class=cm>     */</span>

    <span class=kd>private</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>lastName</span><span class=o>;</span>

    <span class=cm>/*
</span><span class=cm>     * 이름. null이 아니어야 함.
</span><span class=cm>     * @serial
</span><span class=cm>     */</span>
    <span class=kd>private</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>firstName</span><span class=o>;</span>

    <span class=cm>/*
</span><span class=cm>     * 이름. null이 아니어야 함.
</span><span class=cm>     * @serial
</span><span class=cm>     */</span>
    <span class=kd>private</span> <span class=kd>final</span> <span class=n>String</span> <span class=n>middleName</span><span class=o>;</span>

    <span class=o>..</span> 
<span class=o>}</span>
</code></pre></td></tr></table>
</div>
</div><p>성명은 논리적으로 이름, 성, 중간이라는 3개의 문자열로 구성되며, 앞 코드의 인스턴스 필드들은 이 논리적 구성요소를 정확히 반영했음.<br>
</br></br></p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=c1>// 기본 직렬화 형태에 적합하지 않은 클래스
</span><span class=c1></span><span class=kd>public</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>StringList</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
  
  <span class=kd>private</span> <span class=kt>int</span> <span class=n>size</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
  <span class=kd>private</span> <span class=n>Entry</span> <span class=n>head</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
  
  <span class=kd>private</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Entry</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>
    
    <span class=n>String</span> <span class=n>data</span><span class=o>;</span>
    <span class=n>Entry</span> <span class=n>next</span><span class=o>;</span>
    <span class=n>Entry</span> <span class=n>previous</span><span class=o>;</span>
  <span class=o>}</span>
  <span class=o>..</span>
<span class=o>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=객체의-물리적-표환과-논리적-표현의-차이가-클-때-기본-직렬화를-사옹하면-발생하는-문제점>객체의 물리적 표환과 논리적 표현의 차이가 클 때 기본 직렬화를 사옹하면 발생하는 문제점<a hidden class=anchor aria-hidden=true href=#객체의-물리적-표환과-논리적-표현의-차이가-클-때-기본-직렬화를-사옹하면-발생하는-문제점>#</a></h3>
<ol>
<li>
<p>공개 API가 현재 내부 표현 방식에 영구히 묶인다. 위 코드에서는 StringList.Entry가 공개 API가 되어버린다. </br><br>
다음 릴리스에서 내부 표현 방식을 변경하더라도 StringList 클래스는 연결 리스트로 펴현된 입력도 처리할 수 있어야한다.</p>
</li>
<li>
<p>너무 많은 공간을 차지할 수 있다.위 코드에서 직렬화에 필요없는 연결리스트의 모든 엔트리와 연결 정보까지 저장했다.</br>이처럼 직렬화 형태가 너무 커져서 디스크에 저장하거나 네트워크에 전송하는 속도가 느려질 수 있다.</p>
</li>
<li>
<p>시간이 너무 많이 걸릴 수 있다. 직렬화 로직은 객체 그래프의 위상에 관한 정보가 없어서 그래프를 직접 순회해볼 수 밖에 없다.</p>
</li>
<li>
<p>스택 오버플로를 일으킬 수 있다. 기본 직렬화 과정은 객체 그래프를 재귀 순회하는데 크기가 크지 않는 객체 그래프에서도 오버플로를 일으킬 수 있다.</p>
</li>
</ol>
<p>StringList를 합리적으로 직렬화려면 리스트가 포함한 문자열의 개수를 적은 뒤, 그 뒤로 문자열을 나열하는 수준이면 된다. 논리적인 구성만 담는 것이다.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=kd>public</span> <span class=kd>final</span> <span class=kd>class</span> <span class=nc>StringList</span> <span class=kd>implements</span> <span class=n>Serializable</span> <span class=o>{</span>

  <span class=kd>private</span> <span class=kd>transient</span> <span class=kt>int</span> <span class=n>size</span>   <span class=o>=</span> <span class=n>0</span><span class=o>;</span>
  <span class=kd>private</span> <span class=kd>transient</span> <span class=n>Entry</span> <span class=n>head</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
  
  <span class=c1>// 더이상 직렬화 x
</span><span class=c1></span>  <span class=kd>private</span> <span class=kd>static</span> <span class=kd>class</span> <span class=nc>Entry</span> <span class=o>{</span>
    <span class=n>String</span> <span class=n>data</span><span class=o>;</span>
    <span class=n>Entry</span> <span class=n>next</span><span class=o>;</span>
    <span class=n>Entry</span> <span class=n>previous</span><span class=o>;</span>
  <span class=o>}</span>
  <span class=c1>// 지정한 문자열을 이 리스트에 추가
</span><span class=c1></span>  <span class=kd>public</span> <span class=kd>final</span> <span class=kt>void</span> <span class=nf>add</span><span class=o>(</span><span class=n>String</span> <span class=n>s</span><span class=o>)</span> <span class=o>{</span> <span class=o>...</span> <span class=o>}</span>

  <span class=cm>/**
</span><span class=cm>   * Serialize this {@code StringList} instance.
</span><span class=cm>   *
</span><span class=cm>   * @serialData 이 리스트의 크기(포함된 문자열의 개수) 를 기록한 후 ({@code int}), 이어서 모든 원소를(각각은 {@code String})순서대로 기
</span><span class=cm>   */</span>
  <span class=kd>private</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=o>(</span><span class=n>ObjectOutputStream</span> <span class=n>s</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
    <span class=n>s</span><span class=o>.</span><span class=na>defaultWriteObject</span><span class=o>();</span>
    <span class=n>s</span><span class=o>.</span><span class=na>writeInt</span><span class=o>(</span><span class=n>size</span><span class=o>);</span>
    <span class=c1>// 모든 원소를 올바른 순서로 기록한
</span><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=n>Entry</span> <span class=n>e</span> <span class=o>=</span> <span class=n>head</span><span class=o>;</span> <span class=n>e</span> <span class=o>!=</span> <span class=kc>null</span><span class=o>;</span> <span class=n>e</span> <span class=o>=</span> <span class=n>e</span><span class=o>.</span><span class=na>next</span><span class=o>)</span>
      <span class=n>s</span><span class=o>.</span><span class=na>writeObject</span><span class=o>(</span><span class=n>e</span><span class=o>.</span><span class=na>data</span><span class=o>);</span>
  <span class=o>}</span>
  <span class=kd>private</span> <span class=kt>void</span> <span class=nf>readObject</span><span class=o>(</span><span class=n>ObjectInputStream</span> <span class=n>s</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>IOException</span><span class=o>,</span> <span class=n>ClassNotFoundException</span> <span class=o>{</span>
    <span class=n>s</span><span class=o>.</span><span class=na>defaultReadObject</span><span class=o>();</span>
    <span class=kt>int</span> <span class=n>numElements</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=na>readInt</span><span class=o>();</span>
    <span class=c1>// 모든 원소를 읽어 이 리스트에 삽입한다
</span><span class=c1></span>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>numElements</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span>
      <span class=n>add</span><span class=o>((</span><span class=n>String</span><span class=o>)</span> <span class=n>s</span><span class=o>.</span><span class=na>readObject</span><span class=o>());</span>
  <span class=o>}</span>
  <span class=o>..</span>
<span class=o>}</span>

</code></pre></td></tr></table>
</div>
</div><p><code>transient</code>이어도 defaultWriteObject, defaultReadObject를 호출해야 한다. 그래야 향후 릴리스에서 trasient가 아닌 인스턴스 필드가 추가되더라도 상호 호환이 되기 때문이다. <br>
</br><br>
기본 직렬화 사용 여부와 상관없이 객체의 전체 상태를 읽는 메서드에 적용해야 하는 동기화 메커니즘을 직렬화에도 적용해야한다.</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=c1>// 기본 직렬화를 사용하는 동기화된 클래스를 위한 writeObject 메서드
</span><span class=c1></span><span class=kd>private</span> <span class=kd>synchronized</span> <span class=kt>void</span> <span class=nf>writeObject</span><span class=o>(</span><span class=n>ObjectOutputStream</span> <span class=n>s</span><span class=o>)</span> 
    <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
    <span class=n>s</span><span class=o>.</span><span class=na>defaultWriteObject</span><span class=o>();</span>
<span class=o>}</span>
</code></pre></td></tr></table>
</div>
</div><p>writeObject 메서드 안에서 동기화하고 싶으면 클래스의 다른 부분에서 사용하는 락 순서를 똑같이 해야한다. 그렇지 않으면 교착상태에 빠질 수 있다.</p>
</br>
</br>
<p><strong>어떤 직렬화 형태를 택하든 직렬화 가능 클래스 모두에 직렬버전 UID를 명시적으로 부여해주자</strong>.</br><br>
이렇게 해야 잠재적인 호환성 문제가 사라진다. 성능도 조금 빨라지는데 명시하지 않을 경우 런타임에 UID 값을 생성하는 연산을 수행하기 때문이다. 구버전하고 호환성을 끊으려면 값을 변경해주면 된다.</p>
</div>
<footer class=post-footer data-animation=true><div class=post-license-info>
<a class=button rel=license href=https://creativecommons.org/licenses/by-sa/4.0/deed.ko target=_blank>
<img alt="Attribution-ShareAlike 4.0 International" src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png>
</a>
<div class=license-descript>
이 저작물은 <a rel=license href=https://creativecommons.org/licenses/by-sa/4.0/deed.ko target=_blank>크리에이티브 커먼즈 저작자표시-동일조건변경허락 4.0 국제 라이선스</a>에 따라 이용할 수 있습니다.
</div>
</div>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" class=twitter aria-label="share  on twitter" href="https://twitter.com/intent/tweet/?text=&url=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" class=linkedin aria-label="share  on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f&title=&summary=&source=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" class=reddit aria-label="share  on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f&title="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" class=facebook aria-label="share  on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" class=whatsapp aria-label="share  on whatsapp" href="https://api.whatsapp.com/send?text=%20-%20https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" class=telegram aria-label="share  on telegram" href="https://telegram.me/share/url?text=&url=https%3a%2f%2fqutrits.github.io%2feffective-java-3e%2fchapter-11%2fitem87%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
<script>const single_DOMReady=function(a){document.readyState==="interactive"||document.readyState==="complete"?a():document.addEventListener("DOMContentLoaded",a)};single_DOMReady(function(){let c=0,f=0;const b=document.querySelector("header.header"),d="header-bottom",e=b.offsetHeight*-1;let a=0;window.pageYOffset>b.offsetHeight&&(a=e),window.addEventListener("scroll",()=>{c=window.pageYOffset,c<=0?(b.style.marginTop="0px",b.classList.contains(d)&&b.classList.remove(d)):(c>f?e<a&&(a-=5,a<e&&(a=e)):0>a&&(a+=5,a>0&&(a=0)),b.style.marginTop=`${a}px`,b.classList.contains(d)||b.classList.add(d)),f=c}),window.onload=function(){const a=document.querySelectorAll(".post-content .highlight td:nth-child(2) pre code.hljs");for(let b=0;b<a.length;b++)a[b].style.width="100%"}})</script>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://qutrits.github.io/>&lt;Qutrits/></a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
    <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
<span>
· Source code on
<a href=https://github.com/qutrits/qutrits.github.io rel="noopener noreferrer" target=_blank>GitHub</a>
</span>
</footer>
<div class=aside-font-size-button id=aside-font-size-button style=visibility:hidden>
<span class=aside-display-font-size-info>100%</span>
<a id=aside-font-size-increase aria-label="Increase Font size" title="Go to Top (Alt + G)" accesskey=e><svg class="button increase" width="24" height="24" viewBox="0 0 24 24"><path d="M5.12 14 7.5 7.67 9.87 14M6.5 5 1 19H3.25l1.12-3h6.25l1.13 3H14L8.5 5h-2M18 7l-5 5.07 1.41 1.43L17 10.9V17h2V10.9l2.59 2.6L23 12.07 18 7z"/></svg>
</a>
<a id=aside-font-size-decrease aria-label="Decrease Font size" title="Go to Top (Alt + G)" accesskey=d><svg class="button decrease" width="24" height="24" viewBox="0 0 24 24"><path d="M5.12 14 7.5 7.67 9.87 14M6.5 5 1 19H3.25l1.12-3h6.25l1.13 3H14L8.5 5h-2M18 17l5-5.07-1.41-1.43L19 13.1V7H17v6.1l-2.59-2.6L13 11.93 18 17z"/></svg>
</a>
<a id=aside-font-size-default aria-label="Reset Font size" title="Go to Top (Alt + G)" accesskey=f><svg class="button default" width="24" height="24" viewBox="0 0 24 24"><path d="M7.20711 2.54289c.39052.39053.39052 1.02369.0 1.41422L5.41421 5.75H13.25c4.4183.0 8 3.58172 8 8 0 4.4183-3.5817 8-8 8-4.41828.0-8-3.5817-8-8 0-.552300000000001.44772-1 1-1s1 .447699999999999 1 1c0 3.3137 2.68629 6 6 6 3.3137.0 6-2.6863 6-6s-2.6863-6-6-6H5.41421l1.7929 1.79289c.39052.39053.39052 1.02371.0 1.41421C6.81658 11.3476 6.18342 11.3476 5.79289 10.9571l-3.5-3.49999c-.39052-.39053-.39052-1.02369.0-1.41422l3.5-3.5c.39053-.39052 1.02369-.39052 1.41422.0z" fill="#212121"/></svg>
</a>
</div>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class="top-link button" id=top-link accesskey=g style=visibility:hidden><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentcolor"><path d="M414 321.94 274.22 158.82a24 24 0 00-36.44.0L98 321.94c-13.34 15.57-2.28 39.62 18.22 39.62h279.6c20.5.0 31.56-24.05 18.18-39.62z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();const a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"auto"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>const postContent=document.querySelector(".main .post-single .post-content");if(postContent){const a=document.getElementById("aside-font-size-button"),g=a.querySelector("#aside-font-size-increase"),e=a.querySelector("#aside-font-size-decrease"),f=a.querySelector("#aside-font-size-default"),b=document.querySelector(".display-font-size-info"),c=a.querySelector(".aside-display-font-size-info"),i=document.querySelector(".post-single .post-header .post-meta .post-footer"),d=document.querySelector(".post-header"),h=d.offsetHeight+d.offsetTop+d.offsetParent.offsetTop-1;window.addEventListener("scroll",()=>{const b=Math.ceil(window.pageYOffset+window.innerHeight)>=document.body.scrollHeight;h<window.pageYOffset?b&&window.innerWidth<769?(a.style.visibility="hidden",a.style.opacity="0"):(a.style.visibility="visible",a.style.opacity="1"):(a.style.visibility="hidden",a.style.opacity="0")}),g.addEventListener("click",function(){if(localStorage.getItem("post-content-font-size")){let a=parseInt(localStorage.getItem("post-content-font-size"));if(a+5>200)return;postContent.style.fontSize=a+10+"%",b.innerText=a+10+"%",c.innerText=a+10+"%",localStorage.setItem("post-content-font-size",a+10)}else postContent.style.fontSize="110%",b.innerText="110%",c.innerText="110%",localStorage.setItem("post-content-font-size",110)}),e.addEventListener("click",function(){if(localStorage.getItem("post-content-font-size")){let a=parseInt(localStorage.getItem("post-content-font-size"));if(a-5<50)return;postContent.style.fontSize=a-10+"%",b.innerText=a-10+"%",c.innerText=a-10+"%",localStorage.setItem("post-content-font-size",a-10)}else postContent.style.fontSize="90%",b.innerText="90%",c.innerText="90%",localStorage.setItem("post-content-font-size",90)}),f.addEventListener("click",function(){postContent.style.fontSize="100%",b.innerText="100%",c.innerText="100%",localStorage.setItem("post-content-font-size",100)})}</script>
<script>const postContentEl=document.querySelector(".post-content"),topLinkButton=document.getElementById("top-link");window.onscroll=function(){if(postContentEl){const a=postContentEl.getBoundingClientRect(),b=a.top;0>=b?(topLinkButton.style.visibility="visible",topLinkButton.style.opacity="1"):(topLinkButton.style.visibility="hidden",topLinkButton.style.opacity="0")}else window.pageYOffset>300?(topLinkButton.style.visibility="visible",topLinkButton.style.opacity="1"):(topLinkButton.style.visibility="hidden",topLinkButton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body>
</html>