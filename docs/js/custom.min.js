window.location.pathname.startsWith("/post/")&&document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".main .post-single>.toc").offsetTop,s=document.querySelector(".main .toc"),t=[];if(null!==s){const l=s.cloneNode(!0);l.classList.add("aside"),l.querySelector("details").setAttribute("open","");const o=l.querySelectorAll(".inner ul>li");for(let e=0;e<o.length;e++)o[e].classList.contains("non-selected")||(o[e].classList.add("non-selected"),t[e]=decodeURI(o[e].querySelector("a").getAttribute("href")));e<window.pageYOffset?l.classList.add("reveal"):e>=window.pageYOffset&&l.classList.add("hide"),s.parentNode.insertBefore(l,s.nextSibling)}let l=0;const o=document.querySelector("header.header"),c=document.querySelector(".main .toc.aside");let n=null,i=null;window.addEventListener("scroll",()=>{const a=window.pageYOffset;if(e>=a&&c.classList.contains("reveal")&&(c.scrollTop=0,c.classList.remove("reveal"),c.classList.add("hide")),a<=0&&!o.classList.contains("scroll-up"))return o.classList.remove("scroll-down"),void o.classList.add("scroll-up");if(a<=10)o.classList.remove("scroll-up");else{if(a>80&&(a>l&&!o.classList.contains("scroll-down")?(o.classList.remove("scroll-up"),o.classList.add("scroll-down")):a<l&&o.classList.contains("scroll-down")&&(o.classList.remove("scroll-down"),o.classList.add("scroll-up"))),null!==s){e<a&&c.classList.contains("hide")?(c.classList.remove("hide"),c.classList.add("reveal")):e>=a&&c.classList.contains("reveal")&&(c.scrollTop=0,c.classList.remove("reveal"),c.classList.add("hide"));const s=c.querySelectorAll(".inner ul>li");let l=null;for(let e=0;e<t.length;e++){document.querySelector(t[e]).offsetTop<=a&&(n=s[e],l=e)}if(null!==l){if(Math.ceil(a+window.innerHeight)>=document.body.scrollHeight){for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected");s[t.length-1].classList.add("selected"),i=s[t.length-1]}else{if(null!==n&&null!==i&&n===i)return;for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected");n.classList.add("selected"),i=n}null!==l&&c.scroll({behavior:"smooth",top:20*l})}else{if(null===c.querySelector(".selected"))return;for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected")}}l=a}});const a=document.querySelector(".main .toc.aside details");new MutationObserver(()=>{for(let e=0;e<t.length;e++){let s=document.querySelector(t[e+1]),l=document.querySelector(t[e]);window.pageYOffset>=l.offsetTop&&window.pageYOffset<s.offsetTop&&(c.scrollTop=20*e)}}).observe(a,{attributes:!0})});