if(window.location.pathname.startsWith("/post/")){let e=null;document.addEventListener("DOMContentLoaded",()=>{const l=document.querySelector(".main .post-single>.toc"),t=l?l.offsetTop:0,s=document.querySelector("header.header"),o=document.querySelector(".main .toc"),n=[];if(null!==o){const l=o.cloneNode(!0);l.classList.add("aside"),l.querySelector("details").setAttribute("open","");const s=l.querySelectorAll(".inner ul>li");for(let e=0;e<s.length;e++)s[e].classList.contains("non-selected")||(s[e].classList.add("non-selected"),n[e]=decodeURI(s[e].querySelector("a").getAttribute("href").substring(1)));if(t<window.pageYOffset?l.classList.add("reveal"):t>=window.pageYOffset&&l.classList.add("hide"),o.parentNode.insertBefore(l,o.nextSibling),t<window.pageYOffset){const l=document.querySelectorAll(".main .toc.aside .inner ul>li");for(let t=0;t<n.length;t++){let s=document.getElementById(n[t]),o=document.getElementById(n[t+1]);null!==o&&window.pageYOffset>=s.offsetTop&&window.pageYOffset<o.offsetTop&&(l[t].classList.add("selected"),e=t)}}}const c=document.querySelector(".main .toc.aside");let i=null,d=null,a=0;window.addEventListener("scroll",()=>{const e=window.pageYOffset;if(null!==o&&t>=e&&c.classList.contains("reveal")&&(c.scrollTop=0,c.classList.remove("reveal"),c.classList.add("hide")),e<=0&&!s.classList.contains("scroll-up"))return s.classList.remove("scroll-down"),void s.classList.add("scroll-up");if(e<=10)s.classList.remove("scroll-up");else{if(e>80&&(e>a&&!s.classList.contains("scroll-down")?(s.classList.remove("scroll-up"),s.classList.add("scroll-down")):e<a&&s.classList.contains("scroll-down")&&(s.classList.remove("scroll-down"),s.classList.add("scroll-up"))),null!==o){t<e&&c.classList.contains("hide")?(c.classList.remove("hide"),c.classList.add("reveal")):t>=e&&c.classList.contains("reveal")&&(c.scrollTop=0,c.classList.remove("reveal"),c.classList.add("hide"));const l=c.querySelectorAll(".inner ul>li");let s=null;for(let t=0;t<n.length;t++){document.getElementById(n[t]).offsetTop<=e&&(i=l[t],s=t)}if(null!==s){if(Math.ceil(e+window.innerHeight)>=document.body.scrollHeight){for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected");l[n.length-1].classList.add("selected"),d=l[n.length-1]}else{if(i===d&&s>0)return;for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected");i.classList.add("selected"),d=i}null!==s&&c.scroll({behavior:"smooth",top:20*s})}else{if(null===c.querySelector(".selected"))return;for(let e=0;e<l.length;e++)l[e].classList.contains("selected")&&l[e].classList.remove("selected")}}a=e}});const r=document.querySelector(".main .toc.aside details");if(null!==r){new MutationObserver((e,l)=>{if(null===e[0].oldValue)for(let e=0;e<n.length;e++){let l=document.getElementById(n[e]),t=document.getElementById(n[e+1]);if(null!==t&&window.pageYOffset>=l.offsetTop&&window.pageYOffset<t.offsetTop){Math.ceil(window.pageYOffset+window.innerHeight)>=document.body.scrollHeight?(c.querySelectorAll(".inner ul>li")[n.length-1].classList.add("selected"),c.scrollTop=20*(n.length-1)):(c.querySelectorAll(".inner ul>li")[e].classList.add("selected"),c.scrollTop=20*e)}}}).observe(r,{attributes:!0,attributeOldValue:!0,attributeFilter:["open"]})}}),window.onload=function(){null!==e&&(document.querySelector(".main .toc.aside").scrollTop=20*e)}}