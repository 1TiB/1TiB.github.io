if(window.location.pathname.startsWith("/post/")){const e=document.querySelector(".main .post-single>.toc"),l=[];document.addEventListener("DOMContentLoaded",()=>{const t=e?e.offsetTop:0,s=document.querySelector("header.header"),o=document.querySelector(".main .toc");if(null!==o){const e=o.cloneNode(!0);e.classList.add("aside"),e.querySelector("details").setAttribute("open","");const s=e.querySelectorAll(".inner ul>li");for(let e=0;e<s.length;e++)l[e]=decodeURI(s[e].querySelector("a").getAttribute("href").substring(1));t<window.pageYOffset?e.classList.add("reveal"):t>=window.pageYOffset&&e.classList.add("hide"),o.parentNode.insertBefore(e,o.nextSibling)}const n=document.querySelector(".main .toc.aside");let c=null,i=null,d=0;window.addEventListener("scroll",()=>{const e=window.pageYOffset;if(null!==o&&t>=e&&n.classList.contains("reveal")&&(n.scrollTop=0,n.classList.remove("reveal"),n.classList.add("hide")),e<=0&&!s.classList.contains("scroll-up"))return s.classList.remove("scroll-down"),void s.classList.add("scroll-up");if(e<=10)s.classList.remove("scroll-up");else{if(e>80&&(e>d&&!s.classList.contains("scroll-down")?(s.classList.remove("scroll-up"),s.classList.add("scroll-down")):e<d&&s.classList.contains("scroll-down")&&(s.classList.remove("scroll-down"),s.classList.add("scroll-up"))),null!==o){t<e&&n.classList.contains("hide")?(n.classList.remove("hide"),n.classList.add("reveal")):t>=e&&n.classList.contains("reveal")&&(n.scrollTop=0,n.classList.remove("reveal"),n.classList.add("hide"));const s=n.querySelectorAll(".inner ul>li");let o=null;for(let t=0;t<l.length;t++){document.getElementById(l[t]).offsetTop<=e&&(c=s[t],o=t)}if(null!==o){if(Math.ceil(e+window.innerHeight)>=document.body.scrollHeight){for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected");s[l.length-1].classList.add("selected"),i=s[l.length-1]}else{if(c===i&&o>0)return;for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected");c.classList.add("selected"),i=c}null!==o&&n.scroll({behavior:"smooth",top:20*o})}else{if(null===n.querySelector(".selected"))return;for(let e=0;e<s.length;e++)s[e].classList.contains("selected")&&s[e].classList.remove("selected")}}d=e}});const r=document.querySelector(".main .toc.aside details");if(null!==r){new MutationObserver((e,t)=>{if(null===e[0].oldValue)for(let e=0;e<l.length;e++){let t=document.getElementById(l[e]),s=document.getElementById(l[e+1]);if(null!==s&&window.pageYOffset>=t.offsetTop&&window.pageYOffset<s.offsetTop){let t=Math.ceil(window.pageYOffset+window.innerHeight)>=document.body.scrollHeight;n.querySelectorAll(".inner ul>li")[e+1].classList.contains("selected")&&n.querySelectorAll(".inner ul>li")[e+1].classList.remove("selected"),t?(n.querySelectorAll(".inner ul>li")[l.length-1].classList.add("selected"),n.scrollTop=20*(l.length-1)):(n.querySelectorAll(".inner ul>li")[e].classList.add("selected"),n.scrollTop=20*e)}}}).observe(r,{attributes:!0,attributeOldValue:!0,attributeFilter:["open"]})}}),window.onload=function(){if((e?e.offsetTop:0)<window.pageYOffset){const e=document.querySelectorAll(".main .toc.aside .inner ul>li");for(let t=0;t<l.length;t++){let s=document.getElementById(l[t]),o=document.getElementById(l[t+1]);null!==o&&window.pageYOffset>=s.offsetTop&&window.pageYOffset<o.offsetTop&&(null!==e[t+1]&&e[t+1].classList.remove("selected"),e[t].classList.add("selected"),document.querySelector(".main .toc.aside").scrollTop=20*t)}}}}